esphome:
  name: esphome-zehnder-fan
  friendly_name: ESPHome Zehnder fan

esp32:
  board: esp32-c6-devkitc-1
  framework:
    type: esp-idf

# Enable logging
logger:

# Enable Home Assistant API
api:
  encryption:
    key: "redacted"

ota:
  - platform: esphome
    password: "redacted"

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password
  domain: .fritz.box

# SPI configuration for nRF905
spi:
  id: spi_bus
  clk_pin: GPIO21
  mosi_pin: GPIO19
  miso_pin: GPIO20

# External components
external_components:
  - source:
      type: git
      url: https://github.com/srslynow/esphome-zehnder
      ref: main
    refresh: 60sec
    components: [zehnder_fan]

# Fan configuration
fan:
  - platform: zehnder_fan
    id: ventilation_fan
    name: "Mechanical Ventilation"
    spi_id: spi_bus
    
    # Required Pin Configuration
    cs_pin: GPIO18
    pwr_pin: GPIO15
    ce_pin: GPIO5
    txen_pin: GPIO7
    dr_pin: GPIO23

button:
  - platform: restart
    name: "Restart Controller"
  - platform: template
    name: "Pair with Fan"
    icon: "mdi:wifi"
    entity_category: config
    on_press:
      - lambda: |-
          id(ventilation_fan).start_pairing();
